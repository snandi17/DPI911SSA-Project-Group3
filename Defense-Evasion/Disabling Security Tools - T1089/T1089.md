# Technique Description

## T1089 - Disabling Security Tools
## [Description from ATT&CK](https://attack.mitre.org/techniques/T1089/)
<blockquote>
Adversaries may disable security tools to avoid possible detection of their tools and activities. This can take the form of killing security software or event logging processes, deleting Registry keys so that tools do not start at run time, or other methods to interfere with security scanning or event reporting.
</blockquote>

# Assumption
The assumption we took is that the end point here sits in a corporate environment where the "certutil" utility is not used by the end user. Therefore any use of the tool is an attempt to hide artifacts by a adversary already on the network or an insider threat.

# Execution
The Atomic-Red-Team T1140 module describes the test for this technique (https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1140/T1140.md)

# Detection

## Visibility
Detection is done by monitoring process and command line for the malicious behavior mentioned in the assumption section for the “certutil” utility. Using the “-encode” and the “-decode” options with this utility indicate malicious behavior. 

## Splunk Filter
The following splunk query will allow us to detect this technique: host=SPLUNKFWD "C:\\Windows\\System32\\certutil"
